(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function A(){}function be(e){return e()}function pe(){return Object.create(null)}function U(e){e.forEach(be)}function we(e){return typeof e=="function"}function V(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function je(e){return Object.keys(e).length===0}function d(e,t){e.appendChild(t)}function R(e,t,n){e.insertBefore(t,n||null)}function M(e){e.parentNode&&e.parentNode.removeChild(e)}function Ae(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function $(e){return document.createTextNode(e)}function j(){return $(" ")}function Ee(){return $("")}function ye(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Oe(e){return Array.from(e.childNodes)}function G(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function me(e,t,n,o){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function he(e,t,n){for(let o=0;o<e.options.length;o+=1){const i=e.options[o];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Te(e){const t=e.querySelector(":checked");return t&&t.__value}let q;function H(e){q=e}function Le(){if(!q)throw new Error("Function called outside component initialization");return q}function le(e){Le().$$.on_mount.push(e)}const S=[],N=[];let B=[];const se=[],Pe=Promise.resolve();let re=!1;function Ne(){re||(re=!0,Pe.then($e))}function Q(e){B.push(e)}function D(e){se.push(e)}const ne=new Set;let I=0;function $e(){if(I!==0)return;const e=q;do{try{for(;I<S.length;){const t=S[I];I++,H(t),Ce(t.$$)}}catch(t){throw S.length=0,I=0,t}for(H(null),S.length=0,I=0;N.length;)N.pop()();for(let t=0;t<B.length;t+=1){const n=B[t];ne.has(n)||(ne.add(n),n())}B.length=0}while(S.length);for(;se.length;)se.pop()();re=!1,ne.clear(),H(e)}function Ce(e){if(e.fragment!==null){e.update(),U(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}function Ie(e){const t=[],n=[];B.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),B=t}const z=new Set;let Se;function K(e,t){e&&e.i&&(z.delete(e),e.i(t))}function oe(e,t,n,o){if(e&&e.o){if(z.has(e))return;z.add(e),Se.c.push(()=>{z.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function F(e,t,n){const o=e.$$.props[t];o!==void 0&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function ie(e){e&&e.c()}function Y(e,t,n,o){const{fragment:i,after_update:s}=e.$$;i&&i.m(t,n),o||Q(()=>{const u=e.$$.on_mount.map(be).filter(we);e.$$.on_destroy?e.$$.on_destroy.push(...u):U(u),e.$$.on_mount=[]}),s.forEach(Q)}function J(e,t){const n=e.$$;n.fragment!==null&&(Ie(n.after_update),U(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Be(e,t){e.$$.dirty[0]===-1&&(S.push(e),Ne(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function W(e,t,n,o,i,s,u,l=[-1]){const r=q;H(e);const c=e.$$={fragment:null,ctx:[],props:s,update:A,not_equal:i,bound:pe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(r?r.$$.context:[])),callbacks:pe(),dirty:l,skip_bound:!1,root:t.target||r.$$.root};u&&u(c.root);let a=!1;if(c.ctx=n?n(e,t.props||{},(h,y,...b)=>{const f=b.length?b[0]:y;return c.ctx&&i(c.ctx[h],c.ctx[h]=f)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](f),a&&Be(e,h)),y}):[],c.update(),a=!0,U(c.before_update),c.fragment=o?o(c.ctx):!1,t.target){if(t.hydrate){const h=Oe(t.target);c.fragment&&c.fragment.l(h),h.forEach(M)}else c.fragment&&c.fragment.c();t.intro&&K(e.$$.fragment),Y(e,t.target,t.anchor,t.customElement),$e()}H(r)}class X{$destroy(){J(this,1),this.$destroy=A}$on(t,n){if(!we(n))return A;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!je(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function _e(e,t,n){const o=e.slice();return o[4]=t[n][0],o[5]=t[n][1],o}function ge(e){let t,n=e[5]+"",o,i;return{c(){t=g("option"),o=$(n),t.__value=i=e[4],t.value=t.__value},m(s,u){R(s,t,u),d(t,o)},p(s,u){u&2&&n!==(n=s[5]+"")&&G(o,n),u&2&&i!==(i=s[4])&&(t.__value=i,t.value=t.__value)},d(s){s&&M(t)}}}function Ge(e){let t,n,o,i,s,u=Object.entries(e[1]),l=[];for(let r=0;r<u.length;r+=1)l[r]=ge(_e(e,u,r));return{c(){t=g("div"),n=g("select"),o=g("option"),o.textContent="Pick a movie";for(let r=0;r<l.length;r+=1)l[r].c();o.__value="",o.value=o.__value,m(n,"name","movies"),m(n,"id","movies"),m(n,"class","text-slate-800 block mx-auto mb-8 p-2"),e[0]===void 0&&Q(()=>e[2].call(n))},m(r,c){R(r,t,c),d(t,n),d(n,o);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,null);he(n,e[0],!0),i||(s=ye(n,"change",e[2]),i=!0)},p(r,[c]){if(c&2){u=Object.entries(r[1]);let a;for(a=0;a<u.length;a+=1){const h=_e(r,u,a);l[a]?l[a].p(h,c):(l[a]=ge(h),l[a].c(),l[a].m(n,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=u.length}c&3&&he(n,r[0])},i:A,o:A,d(r){r&&M(t),Ae(l,r),i=!1,s()}}}function He(e,t,n){let o=[],{activeMovie:i}=t;const s=l=>Object.keys(l).sort().reduce((r,c)=>(r[c]=l[c],r),{});le(async()=>{const a=await(await fetch("https://uinelj.github.io/lbxd-stats/res/watchlist_new.json",{method:"GET",headers:{"Content-Type":"application/json"}})).json();n(1,o=s(a))});function u(){i=Te(this),n(0,i),n(1,o)}return e.$$set=l=>{"activeMovie"in l&&n(0,i=l.activeMovie)},[i,o,u]}class qe extends X{constructor(t){super(),W(this,t,He,Ge,V,{activeMovie:0})}}function De(e){let t,n,o;return{c(){t=g("div"),n=j(),o=g("script"),o.textContent='import "https://cdn.plot.ly/plotly-2.18.2.min.js";',m(o,"type","module")},m(i,s){R(i,t,s),e[3](t),R(i,n,s),d(document.head,o)},p:A,i:A,o:A,d(i){i&&M(t),e[3](null),i&&M(n),M(o)}}}function Fe(e,t,n){let{movie:o="robots"}=t,{useAbsoluteRatingRange:i=!1}=t,s;async function u(r,c){if(r==null)return;const a="https://uinelj.github.io/lbxd-stats/res/graph_data/"+o+".json",b=await(await fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}})).json(),f={title:r,paper_bgcolor:"rgba(0, 0, 0, 0)",plot_bgcolor:"rgba(0, 0, 0, 0)",font:{color:"rgb(226 232 240)"},yaxis:{gridcolor:"rgb(71 85 105)",range:c?[.5,5]:null},xaxis:{gridcolor:"rgb(71 85 105)"},display_mode_bar:!1,colorway:["#000000"],showlegend:!0};b.layout=f,b.data[0].text=[],Plotly.newPlot(s,b,{display_mode_bar:!1})}le(async()=>{u(o,i)});function l(r){N[r?"unshift":"push"](()=>{s=r,n(0,s)})}return e.$$set=r=>{"movie"in r&&n(1,o=r.movie),"useAbsoluteRatingRange"in r&&n(2,i=r.useAbsoluteRatingRange)},e.$$.update=()=>{e.$$.dirty&6&&u(o,i)},[s,o,i,l]}class ze extends X{constructor(t){super(),W(this,t,Fe,De,V,{movie:1,useAbsoluteRatingRange:2})}}function ve(e){let t,n,o=e[1].title+"",i,s,u,l,r,c,a,h=e[1].overview+"",y,b,f,O,k,T,x,L,w,C,P;return{c(){t=g("h2"),n=g("a"),i=$(o),u=$(`
        (`),l=$(e[2]),r=$(")"),c=j(),a=g("p"),y=$(h),b=j(),f=g("div"),O=$("More on: "),k=g("a"),T=$("TMDB"),L=j(),w=g("a"),C=$("Letterboxd"),m(n,"class","text-slate-300 underline"),m(n,"href",s="https://www.themoviedb.org/movie/"+e[1].id),m(t,"class","text-xl text-center"),m(a,"class","text-justify mt-1"),m(k,"class","mt-4 p-1 font-semibold text-sm bg-slate-500 text-white rounded-none shadow-sm"),m(k,"href",x="https://www.themoviedb.org/movie/"+e[1].id+`
        `),m(w,"class","mt-4 p-1 font-semibold text-sm bg-slate-500 text-white rounded-none shadow-sm"),m(w,"href",P="https://www.letterboxd.com/film/"+e[0]+`
        `),m(f,"class","mt-4 text-right")},m(_,v){R(_,t,v),d(t,n),d(n,i),d(t,u),d(t,l),d(t,r),R(_,c,v),R(_,a,v),d(a,y),R(_,b,v),R(_,f,v),d(f,O),d(f,k),d(k,T),d(f,L),d(f,w),d(w,C)},p(_,v){v&2&&o!==(o=_[1].title+"")&&G(i,o),v&2&&s!==(s="https://www.themoviedb.org/movie/"+_[1].id)&&m(n,"href",s),v&4&&G(l,_[2]),v&2&&h!==(h=_[1].overview+"")&&G(y,h),v&2&&x!==(x="https://www.themoviedb.org/movie/"+_[1].id+`
        `)&&m(k,"href",x),v&1&&P!==(P="https://www.letterboxd.com/film/"+_[0]+`
        `)&&m(w,"href",P)},d(_){_&&M(t),_&&M(c),_&&M(a),_&&M(b),_&&M(f)}}}function Ke(e){let t,n=e[1]&&ve(e);return{c(){n&&n.c(),t=Ee()},m(o,i){n&&n.m(o,i),R(o,t,i)},p(o,[i]){o[1]?n?n.p(o,i):(n=ve(o),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:A,o:A,d(o){n&&n.d(o),o&&M(t)}}}function Ye(e,t,n){let{activeMovie:o="12 Years a Slave"}=t,i,s;le(()=>{l(o)});const u="https://uinelj.github.io/lbxd-stats/res/movie_data/";async function l(r){let c=u+`${r}.json`;console.log(c);let a=await fetch(c);n(1,i=await a.json()),n(2,s=i.release_date.split("-")[0]),console.log(i)}return e.$$set=r=>{"activeMovie"in r&&n(0,o=r.activeMovie)},e.$$.update=()=>{e.$$.dirty&1&&l(o)},[o,i,s]}class Je extends X{constructor(t){super(),W(this,t,Ye,Ke,V,{activeMovie:0})}}function Qe(e){let t,n,o,i,s,u,l,r,c,a,h,y,b,f,O,k,T,x,L,w,C,P,_,v,Z,ae;function Me(p){e[5](p)}let ue={};e[0]!==void 0&&(ue.activeMovie=e[0]),l=new qe({props:ue}),N.push(()=>F(l,"activeMovie",Me));function xe(p){e[6](p)}function ke(p){e[7](p)}let ee={};e[0]!==void 0&&(ee.movie=e[0]),e[1]!==void 0&&(ee.useAbsoluteRatingRange=e[1]),a=new ze({props:ee}),N.push(()=>F(a,"movie",xe)),N.push(()=>F(a,"useAbsoluteRatingRange",ke));function Re(p){e[8](p)}let ce={};return e[0]!==void 0&&(ce.activeMovie=e[0]),w=new Je({props:ce}),N.push(()=>F(w,"activeMovie",Re)),{c(){t=g("main"),n=g("div"),o=g("h1"),o.textContent="Letterstonks",i=j(),s=g("div"),s.innerHTML=`<p>Track the rating evolution of movies!</p> 
      <p>Note that movies ratings are monitored and logged periodically, so you
        can&#39;t go back in time.</p>`,u=j(),ie(l.$$.fragment),c=j(),ie(a.$$.fragment),b=j(),f=g("button"),O=$("Rating range: "),k=$(e[2]),T=j(),x=g("div"),L=g("div"),ie(w.$$.fragment),P=j(),_=g("div"),_.innerHTML=`<h2 class="text-xl">How does that work?</h2> 
        <p class="m-2 p-2 max-w-md">Each 12 hours, I get the most popular movies of the week/year/all
          time, and add them in a watchlist if they aren&#39;t yet there. Then, for
          the new additions, I get their current rating.
          <br/>
          Then, I get the rating of <code>n</code>
          movies that are already in the watchlist. The <code>n</code> is defined
          so that all movies are updated at least once a week via random sampling.</p>`,m(o,"class","text-2xl m-auto text-right pt-8 mr-2 font-serif"),m(s,"class","mx-auto my-20 p-20"),m(f,"class","mx-4 px-4 py-2 font-semibold text-sm bg-slate-500 text-white rounded-none shadow-sm ml-4"),m(f,"type","button"),m(L,"class","p-2 basis-1/2 md:basis-full"),m(_,"class","p-2 basis-1/2 md:basis-full"),m(x,"class","flex flex-row md:flex-1"),m(n,"class","my-0 mx-auto max-w-7xl backdrop-blur-lg"),m(t,"class","backdrop bg-cover bg-no-repeat bg-fixed m-0 p-0 h-full text-slate-200 overflow-y-scroll svelte-1ng59wk"),me(t,"--backdrop_css",e[3])},m(p,E){R(p,t,E),d(t,n),d(n,o),d(n,i),d(n,s),d(n,u),Y(l,n,null),d(n,c),Y(a,n,null),d(n,b),d(n,f),d(f,O),d(f,k),d(n,T),d(n,x),d(x,L),Y(w,L,null),d(x,P),d(x,_),v=!0,Z||(ae=ye(f,"click",e[4]),Z=!0)},p(p,[E]){const fe={};!r&&E&1&&(r=!0,fe.activeMovie=p[0],D(()=>r=!1)),l.$set(fe);const te={};!h&&E&1&&(h=!0,te.movie=p[0],D(()=>h=!1)),!y&&E&2&&(y=!0,te.useAbsoluteRatingRange=p[1],D(()=>y=!1)),a.$set(te),(!v||E&4)&&G(k,p[2]);const de={};!C&&E&1&&(C=!0,de.activeMovie=p[0],D(()=>C=!1)),w.$set(de),(!v||E&8)&&me(t,"--backdrop_css",p[3])},i(p){v||(K(l.$$.fragment,p),K(a.$$.fragment,p),K(w.$$.fragment,p),v=!0)},o(p){oe(l.$$.fragment,p),oe(a.$$.fragment,p),oe(w.$$.fragment,p),v=!1},d(p){p&&M(t),J(l),J(a),J(w),Z=!1,ae()}}}const Ue="https://image.tmdb.org/t/p/w1280";function Ve(e,t,n){const o="https://uinelj.github.io/lbxd-stats/res/movie_data/";async function i(f){const O=o+`${f}.json`,T=await(await fetch(O)).json();return`url(${Ue+T.backdrop_path})`}let s,u,l="relative",r=null;function c(){n(1,u=!u),u?n(2,l="absolute"):n(2,l="relative")}function a(f){s=f,n(0,s)}function h(f){s=f,n(0,s)}function y(f){u=f,n(1,u)}function b(f){s=f,n(0,s)}return e.$$.update=()=>{e.$$.dirty&1&&i(s).then(f=>n(3,r=f))},[s,u,l,r,c,a,h,y,b]}class We extends X{constructor(t){super(),W(this,t,Ve,Qe,V,{})}}new We({target:document.getElementById("app")});
